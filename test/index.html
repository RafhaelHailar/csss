<script type="test">
  import { SheetWrapper } from "../src/engine.js";

  (function happyTest() {
    const style = document.querySelector('style');
    const sheetWrapper = new SheetWrapper(style.sheet);
    for (let el of document.body.querySelectorAll('[class*="$"]'))
      for (let clazz of el.classList)
        if (clazz.includes("$"))
          try { sheetWrapper.addRule(clazz); } catch (er) { console.error(er); }
    
    requestAnimationFrame(_ => sheetWrapper.cleanup());
  })();

</script>

<script type="module">
  const paths = (location.hash.slice(1) || "HappyPath").split(",").map(p => p + ".html");
  for (let file of paths)
    document.body.insertAdjacentHTML('beforeend', await(await fetch(file)).text());
  const happy = document.querySelector('script[type="test"]').outerHTML;
  for (let test of document.querySelectorAll("test-html")) {
    test.querySelector('style').setAttribute("expected", "");
    test.insertAdjacentHTML('beforeend', happy);
  }

  import("https://cdn.jsdelivr.net/gh/orstavik/TestHTML@v1.2.4/TestHTMLexpected.js");
</script>